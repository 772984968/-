<?phpnamespace lib\forms;use lib\vendor\imagine\Image\Point;use Yii;use lib\models\Buddy;use lib\models\BuddyGroup;//好友表单class BuddyForm extends CaptchaForm{    public $iid;    public $user_id;    public $group_id;    public $buddy_id;    public $remark;    public function scenarios()    {        return [            'add' => [                'user_id',                'group_id',                'buddy_id',            ],            'delete' => [                'iid',                'user_id',            ],            'move' => [                'iid',                'user_id',                'group_id',            ],            'remark' =>[                'buddy_id',                'remark'            ],            'applyAdd' => [                '' => '',            ],        ];    }    public function rules()    {        return [            [['iid', 'user_id', 'buddy_id', 'remark'], 'required'],            ['group_id', 'required', 'on' => ['move']],            [['iid', 'user_id', 'group_id', 'buddy_id'], 'integer'],            [['remark'], 'string', 'max' => 15],        ];    }    public function attributeLabels()    {        return [        ];    }    //添加好友    public function add()    {        if($this->validate())        {            if(Buddy::findOne(['user_id'=>$this->user_id, 'buddy_id'=>$this->buddy_id])) {                $this->addError('iid', '你们已经是好友了!');                return false;            }            $model = new Buddy();            $model->user_id = $this->user_id;            $model->buddy_id = $this->buddy_id;            if($this->group_id) {                $model->group_id = $this->group_id;            } else {                $buddyGroupModel = BuddyGroup::findOne(['user_id'=>$this->user_id, 'is_system'=>'1']);                $model->group_id = $buddyGroupModel->iid ?? 0;            }            if( $model->save() ) {                return true;            } else {                $this->addError('iid', Yii::t('common','fail'));            }        }    }    //申请添加    public function applyAdd() {    }    //同意添加    public function agreeAdd() {    }    //拒绝添加    public function refuseAdd() {    }    public function update()    {    }    public function delete()    {    }    public function remark()    {    }}