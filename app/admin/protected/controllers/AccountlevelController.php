<?phpnamespace app\controllers;use lib\models\AccountLevel;//帐号等级类class AccountlevelController extends TemplateController{    public $config = [        'modelName' => 'lib\models\AccountLevel',        'modelShortName' => 'AccountLevel',        'listUrl' => 'AccountLevel',        'addUrl' => 'AccountLevelAdd',        'delUrl' => 'AccountLevelDel',        'chgUrl' => 'AccountLevelEdit',        'addTitle' => '添加',        'addFormName' => '参数',        'chgTitle' => '修改',        'chgFormName' => '参数',        'listTitle' => '标签列表',        'listFormName' => '参数',    ];    //可搜索的选项    public function getSearch()    {        return [        ];    }    /**     * [actionIndex 主列表]     * @return [type] [description]     */    public function actionIndex()    {        $this->data['search'] = $this->getSearch();        $this->setIndexData();        $this->data['config'] = $this->config;        $this->data['title'] = $this->getIndexField();        return $this->view('../template/index');    }    //添加修改中定主的字段    protected function getOption()    {        return [            ['key'=>'name','value'=>'','html'=>'text','option'=>''],            ['key'=>'credits','value'=>'','html'=>'text','option'=>''],            ['key'=>'withdrawal_proportion','value'=>'','html'=>'text','option'=>''],            ['key'=>'diamond_proportion','value'=>'','html'=>'text','option'=>''],        ];    }    //设置首页显示的数据    protected function setIndexData()    {        $search = $this->get('search');        $where  = '1=1';        $where_keyword = [];        //搜索        if(!empty($search['type']) && !empty($search['keyword']))        {            $where .= " and " . $search['type'] ." like :like";            $where_keyword = [':like'=>"%{$search['keyword']}%"];        }        //添加时间搜索        if(!empty($search['stime']))        {            $stime = strtotime($search['stime']);            $etime = empty($search['etime']) ? time() : strtotime($search['etime']);            $where .= " and UNIX_TIMESTAMP(create_time) between " . $stime ." and " . $etime;        }        $primaryKey = $this->config['modelName']::primaryKey()[0];        $query = $this->config['modelName']::find()        ->where($where,$where_keyword)->orderBy('credits ASC');        $this->data['count'] = $query->count();        $this->data['page']  = $this->page( $this->data['count'] );        $page = \Yii::$app->getRequest()->get('page', 0);        $start = $page>0 ? ($page-1)*20 : 0;        $this->data['data']  = $query->offset($start)->limit(20)->all();        $this->data['searchvalue'] = $search;    }    //主页中显示的字段名    public function getIndexField()    {        return [            'iid',            'name',            'credits',            'withdrawal_proportion',            'diamond_proportion',        ];    }}?>